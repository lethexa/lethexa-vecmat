/*! lethexa-vecmat 2016-12-04 Copyright by Tim Leerhoff <tleerhof@web.de> */
!function(a){"use strict";var b=2*Math.PI,c=function(a,b){var c=Math.pow(10,b);return Math.round(a*c)/c},d=function(a){for(;a>=b;)a-=b;for(;0>a;)a+=b;return a},e=function(a){for(;a<-Math.PI;)a+=b;for(;a>=Math.PI;)a-=b;return a};a.MathFunc3d={makeVector:function(b){return new a.Vector3d(b[0],b[1],b[2])},nullVector:function(){return new a.Vector3d(0,0,0)},add:function(a,b){return a.add(b)},sub:function(a,b){return a.sub(b)},mulScalar:function(a,b){return a.mulScalar(b)},dot:function(a,b){return a.dot(b)},cross:function(a,b){return a.cross(b)},unit:function(a){return a.unit()},toArray:function(a){return a.toArray()},lengthSquared:function(a){return a.lengthSquared()}},a.intersectionAtPositiveYAxis2d=function(b,c){if(!(b._y<0&&c._y<0||b._x<0&&c._x<0||b._x>0&&c._x>0)){var d,e=c._y-b._y,f=c._x-b._x;if(0===f){if(d=c._y<b._y?c._y:b._y,0>d)return;return a.vector3dFromElements(0,d,0)}if(d=b._y+e/f*(0-b._x),!(0>d))return a.vector3dFromElements(0,d,0)}},a.vector2dFromString=function(b){var c=b.split(";");if(c.length<2)throw new Error("Too few arguments");return new a.Vector2d(parseFloat(c[0]),parseFloat(c[1]))},a.vector2dFromPolar=function(b,c){return new a.Vector2d(c*Math.cos(b),c*Math.sin(b))},a.vector2dFromArray=function(b){return new a.Vector2d(b[0],b[1])},a.vector2dFromElements=function(b,c){return new a.Vector2d(b,c)},a.Vector2d=function(a,b){this._x=a,this._y=b},a.Vector2d.prototype.round=function(b){return new a.Vector2d(c(this._x,b),c(this._y,b))},a.Vector2d.prototype.isEqualTo=function(a){return this._x!==a._x?!1:this._y===a._y},a.Vector2d.prototype.x=function(){return this._x},a.Vector2d.prototype.y=function(){return this._y},a.Vector2d.prototype.length=function(){return Math.sqrt(this.lengthSquared())},a.Vector2d.prototype.lengthSquared=function(){return this._x*this._x+this._y*this._y},a.Vector2d.prototype.distanceTo=function(a){return a.sub(this).length()},a.Vector2d.prototype.unit=function(){var b=this.length();if(0!==b)return new a.Vector2d(this._x/b,this._y/b)},a.Vector2d.prototype.neg=function(){return new a.Vector2d(-this._x,-this._y)},a.Vector2d.prototype.pitch=function(){var a=Math.atan2(this._y,this._x);return a},a.Vector2d.prototype.add=function(b){return new a.Vector2d(this._x+b._x,this._y+b._y)},a.Vector2d.prototype.sub=function(b){return new a.Vector2d(this._x-b._x,this._y-b._y)},a.Vector2d.prototype.mul=function(a){return this.mulScalar(a)},a.Vector2d.prototype.mulScalar=function(b){return new a.Vector2d(this._x*b,this._y*b)},a.Vector2d.prototype.dot=function(a){return this._x*a._x+this._y*a._y},a.Vector2d.prototype.toArray=function(){return[this._x,this._y]},a.Vector2d.prototype.toString=function(){return""+this._x+";"+this._y};var f=Object.freeze(new a.Vector2d(1,0)),g=Object.freeze(new a.Vector2d(0,1)),h=Object.freeze(new a.Vector2d(0,0));a.makeUnitXVector2d=function(){return f},a.makeUnitYVector2d=function(){return g},a.makeNullVector2d=function(){return h},a.vector3dFromString=function(b){var c=b.split(";");if(c.length<3)throw new Error("Too few arguments");return new a.Vector3d(parseFloat(c[0]),parseFloat(c[1]),parseFloat(c[2]))},a.vector3dFromPolar=function(b,c,d){var e=d*Math.cos(b),f=-d*Math.sin(b);return new a.Vector3d(e*Math.cos(c),e*Math.sin(c),f)},a.vector3dFromArray=function(b){return new a.Vector3d(b[0],b[1],b[2])},a.vector3dFromElements=function(b,c,d){return new a.Vector3d(b,c,d)},a.Vector3d=function(a,b,c){this._x=a,this._y=b,this._z=c},a.Vector3d.prototype.round=function(b){return new a.Vector3d(c(this._x,b),c(this._y,b),c(this._z,b))},a.Vector3d.prototype.isEqualTo=function(a){return this._x!==a._x?!1:this._y!==a._y?!1:this._z===a._z},a.Vector3d.prototype.x=function(){return this._x},a.Vector3d.prototype.y=function(){return this._y},a.Vector3d.prototype.z=function(){return this._z},a.Vector3d.prototype.length=function(){return Math.sqrt(this.lengthSquared())},a.Vector3d.prototype.distanceTo=function(a){return a.sub(this).length()},a.Vector3d.prototype.lengthSquared=function(){return this._x*this._x+this._y*this._y+this._z*this._z},a.Vector3d.prototype.unit=function(){var b=this.length();if(0!==b)return new a.Vector3d(this._x/b,this._y/b,this._z/b)},a.Vector3d.prototype.neg=function(){return new a.Vector3d(-this._x,-this._y,-this._z)},a.Vector3d.prototype.pitch=function(){var a=Math.sqrt(this._x*this._x+this._y*this._y),b=-Math.atan2(this._z,a);return b},a.Vector3d.prototype.yaw=function(){var a=Math.atan2(this._y,this._x);return a},a.Vector3d.prototype.add=function(b){return new a.Vector3d(this._x+b._x,this._y+b._y,this._z+b._z)},a.Vector3d.prototype.sub=function(b){return new a.Vector3d(this._x-b._x,this._y-b._y,this._z-b._z)},a.Vector3d.prototype.mul=function(a){return this.mulScalar(a)},a.Vector3d.prototype.mulScalar=function(b){return new a.Vector3d(this._x*b,this._y*b,this._z*b)},a.Vector3d.prototype.dot=function(a){return this._x*a._x+this._y*a._y+this._z*a._z},a.Vector3d.prototype.cross=function(b){var c=this._y*b._z-this._z*b._y,d=this._z*b._x-this._x*b._z,e=this._x*b._y-this._y*b._x;return new a.Vector3d(c,d,e)},a.Vector3d.prototype.spat=function(a,b){return this.dot(a.cross(b))},a.Vector3d.prototype.toArray=function(){return[this._x,this._y,this._z]},a.Vector3d.prototype.toString=function(){return""+this._x+";"+this._y+";"+this._z};var i=Object.freeze(new a.Vector3d(1,0,0)),j=Object.freeze(new a.Vector3d(0,1,0)),k=Object.freeze(new a.Vector3d(0,0,1)),l=Object.freeze(new a.Vector3d(0,0,0));a.makeUnitXVector3d=function(){return i},a.makeUnitYVector3d=function(){return j},a.makeUnitZVector3d=function(){return k},a.makeNullVector3d=function(){return l},a.matrix3x3FromArray=function(b){return new a.Matrix3x3(b)},a.makeUnitMatrix3x3=function(){return new a.Matrix3x3([[1,0,0],[0,1,0],[0,0,1]])},a.makeNullMatrix3x3=function(){return new a.Matrix3x3([[0,0,0],[0,0,0],[0,0,0]])},a.toGlobalMatrix3x3=function(b,c,d){var e=a.makeUnitMatrix3x3();return 0!==b&&(e=a.makeXRotation3x3(b).mul(e)),0!==c&&(e=a.makeYRotation3x3(c).mul(e)),0!==d&&(e=a.makeZRotation3x3(d).mul(e)),e},a.toLocalMatrix3x3=function(b,c,d){var e=a.makeUnitMatrix3x3();return 0!==d&&(e=a.makeZRotation3x3(d).mul(e)),0!==c&&(e=a.makeYRotation3x3(c).mul(e)),0!==b&&(e=a.makeXRotation3x3(b).mul(e)),e},a.makeXRotation3x3=function(b){var c=Math.sin(b),d=Math.cos(b);return new a.Matrix3x3([[1,0,0],[0,d,-c],[0,c,d]])},a.makeYRotation3x3=function(b){var c=Math.sin(b),d=Math.cos(b);return new a.Matrix3x3([[d,0,c],[0,1,0],[-c,0,d]])},a.makeZRotation3x3=function(b){var c=Math.sin(b),d=Math.cos(b);return new a.Matrix3x3([[d,-c,0],[c,d,0],[0,0,1]])},a.makeScale3x3=function(b,c,d){return new a.Matrix3x3([[b,0,0],[0,c,0],[0,0,d]])},a.Matrix3x3=function(a){if(a.length<3)throw new Error("vertical array to short");this._elements=a,this.e11=this._elements[0][0],this.e12=this._elements[0][1],this.e13=this._elements[0][2],this.e21=this._elements[1][0],this.e22=this._elements[1][1],this.e23=this._elements[1][2],this.e31=this._elements[2][0],this.e32=this._elements[2][1],this.e33=this._elements[2][2]},a.Matrix3x3.prototype.round=function(b){return new a.Matrix3x3([[c(this.e11,b),c(this.e12,b),c(this.e13,b)],[c(this.e21,b),c(this.e22,b),c(this.e23,b)],[c(this.e31,b),c(this.e32,b),c(this.e33,b)]])},a.Matrix3x3.prototype.isEqualTo=function(a){var b,c;for(c=0;c<this._elements.length;c++)for(b=0;b<this._elements[c].length;b++)if(this._elements[c][b]!==a._elements[c][b])return!1;return!0},a.Matrix3x3.prototype.mulScalar=function(b){return new a.Matrix3x3([[this.e11*b,this.e12*b,this.e13*b],[this.e21*b,this.e22*b,this.e23*b],[this.e31*b,this.e32*b,this.e33*b]])},a.Matrix3x3.prototype.mulVector=function(b){if(!(b instanceof a.Vector3d))throw new Error("u is not a Vector3d");return new a.Vector3d(this.e11*b.x()+this.e12*b.y()+this.e13*b.z(),this.e21*b.x()+this.e22*b.y()+this.e23*b.z(),this.e31*b.x()+this.e32*b.y()+this.e33*b.z())},a.Matrix3x3.prototype.mul=function(b){if(!(b instanceof a.Matrix3x3))throw new Error("m is not a Matrix3x3");return new a.Matrix3x3([[this.e11*b.e11+this.e12*b.e21+this.e13*b.e31,this.e11*b.e12+this.e12*b.e22+this.e13*b.e32,this.e11*b.e13+this.e12*b.e23+this.e13*b.e33],[this.e21*b.e11+this.e22*b.e21+this.e23*b.e31,this.e21*b.e12+this.e22*b.e22+this.e23*b.e32,this.e21*b.e13+this.e22*b.e23+this.e23*b.e33],[this.e31*b.e11+this.e32*b.e21+this.e33*b.e31,this.e31*b.e12+this.e32*b.e22+this.e33*b.e32,this.e31*b.e13+this.e32*b.e23+this.e33*b.e33]])},a.Matrix3x3.prototype.add=function(b){return new a.Matrix3x3([[this.e11+b.e11,this.e12+b.e12,this.e13+b.e13],[this.e21+b.e21,this.e22+b.e22,this.e23+b.e23],[this.e31+b.e31,this.e32+b.e32,this.e33+b.e33]])},a.Matrix3x3.prototype.sub=function(b){return new a.Matrix3x3([[this.e11-b.e11,this.e12-b.e12,this.e13-b.e13],[this.e21-b.e21,this.e22-b.e22,this.e23-b.e23],[this.e31-b.e31,this.e32-b.e32,this.e33-b.e33]])},a.Matrix3x3.prototype.transpose=function(){return new a.Matrix3x3([[this.e11,this.e21,this.e31],[this.e12,this.e22,this.e32],[this.e13,this.e23,this.e33]])},a.Matrix3x3.prototype.det=function(){return this.e11*this.e22*this.e33+this.e12*this.e23*this.e31+this.e13*this.e21*this.e32-this.e13*this.e22*this.e31-this.e11*this.e23*this.e32-this.e12*this.e21*this.e33},a.Matrix3x3.prototype.inverse=function(){var b=this.det();return 0===b&&(b=1),a.matrix3x3FromArray([[(this.e22*this.e23-this.e23*this.e32)/b,-(this.e12*this.e33-this.e13*this.e32)/b,(this.e12*this.e23-this.e13*this.e22)/b],[-(this.e21*this.e33-this.e23*this.e31)/b,(this.e11*this.e33-this.e13*this.e31)/b,-(this.e11*this.e23-this.e13*this.e21)/b],[(this.e21*this.e32-this.e22*this.e31)/b,-(this.e11*this.e32-this.e12*this.e31)/b,(this.e11*this.e22-this.e12*this.e21)/b]])},a.Matrix3x3.prototype.phi=function(){return Math.atan2(this.e32,this.e33)},a.Matrix3x3.prototype.theta=function(){return Math.asin(-this.e31)},a.Matrix3x3.prototype.psi=function(){return Math.atan2(this.e21,this.e11)},a.Matrix3x3.prototype.toArray=function(){return[[this.e11,this.e12,this.e13],[this.e21,this.e22,this.e23],[this.e31,this.e32,this.e33]]},a.Matrix3x3.prototype.toString=function(){var a="";return this._elements.forEach(function(b){b.forEach(function(b){a+=""+b+","}),a+="\n"}),a},a.shortestArcQuat=function(b,c){b=b.unit(),c=c.unit();var d=b.cross(c),e=b.dot(c);if(-1===e)return a.quatFromRotation(Math.PI,a.makeNullVector3d());if(1===e)return a.quatFromRotation(0,a.makeUnitZVector3d());var f=Math.sqrt(2*(1+e));return new a.Quat(f/2,new a.Vector3d(d.x()/f,d.y()/f,d.z()/f))},a.quatFromEulerAngles=function(b,c,d){var e=Math.cos(.5*b),f=Math.cos(.5*c),g=Math.cos(.5*d),h=Math.sin(.5*b),i=Math.sin(.5*c),j=Math.sin(.5*d),k=g*f,l=j*i,m=g*i,n=j*f;return new a.Quat(k*e+l*h,new a.Vector3d(k*h-l*e,m*e+n*h,n*e-m*h))},a.quatFromRotation=function(b,c){var d=.5*b;return new a.Quat(Math.cos(d),c.mul(Math.sin(d)))},a.quatFromVector3d=function(b){return new a.Quat(0,b)},a.Quat=function(a,b){if(void 0===a)throw new Error("r is undefined");if(void 0===b)throw new Error("v is undefined");this._r=a,this._v=b},a.Quat.prototype.round=function(b){return new a.Quat(c(this._r,b),this._v.round(b))},a.Quat.prototype.isEqualTo=function(a){return this._r!==a._r?!1:!!this._v.isEqualTo(a._v)},a.Quat.prototype.real=function(){return this._r},a.Quat.prototype.imag=function(){return this._v},a.Quat.prototype.add=function(b){return new a.Quat(this._r+b._r,this._v.add(b._v))},a.Quat.prototype.sub=function(b){return new a.Quat(this._r-b._r,this._v.sub(b._v))},a.Quat.prototype.lengthSquared=function(){var a=this._v.lengthSquared();return this._r*this._r+a},a.Quat.prototype.length=function(){return Math.sqrt(this.lengthSquared())},a.Quat.prototype.unit=function(){var b=this.length();if(0===b)throw new Error("unit not possible because length is 0");var c=1/b;return new a.Quat(this._r*c,this._v.mul(c))},a.Quat.prototype.dot=function(a){return a._r*this._r+a._v.x()*this._v.x()+a._v.y()*this._v.y()+a._v.z()*this._v.z()},a.Quat.prototype.axis=function(){var b=this.length();return 0===b?new a.Vector3d(0,0,0):this._v.mul(b)},a.Quat.prototype.angle=function(){return 2*Math.acos(this._r)},a.Quat.prototype.angleTo=function(a){return 2*Math.acos(this.dot(a))},a.Quat.prototype.lerpTo=function(a,b){var c=this;return c.mulScalar(1-b).add(a.mulScalar(b))},a.Quat.prototype.slerpTo=function(a,b){var c=this,d=a,e=c.dot(d);0>e?(d=-d,e=c.dot(d)):e>1&&(e=1);var f=Math.acos(e);if(0===f)return c;var g=Math.sin(f),h=Math.sin((1-b)*f)/g,i=Math.sin(b*f)/g;return c.mulScalar(h).add(d.mulScalar(i))},a.Quat.prototype.neg=function(){return new a.Quat(-this._r,this._v.neg())},a.Quat.prototype.conj=function(){return new a.Quat(this._r,this._v.neg())},a.Quat.prototype.pow=function(b){return new a.Quat(b*this.angle(),this.axis())},a.Quat.prototype.mulScalar=function(b){return new a.Quat(this._r*b,this._v.mulScalar(b))},a.Quat.prototype.toEulerAngles=function(a){var b=this._r,c=this._v.x(),e=this._v.y(),f=this._v.z();return[d(Math.atan2(e*f+b*c,.5-(c*c+e*e))),Math.asin(-2*(c*f+b*e)),d(Math.atan2(c*e+b*f,.5-(e*e+f*f)))]},a.Quat.prototype.rotateVector=function(b){return this.mul(a.quatFromVector3d(b)).mul(this.conj()).imag()},a.Quat.prototype.mul=function(b){var c=this._r,d=this._v.x(),e=this._v.y(),f=this._v.z(),g=b._r,h=b._v.x(),i=b._v.y(),j=b._v.z();return new a.Quat(c*g-d*h-e*i-f*j,new a.Vector3d(c*h+d*g+e*j-f*i,c*i+e*g+f*h-d*j,c*j+f*g+d*i-e*h))},a.Quat.prototype.mulVector=function(b){var c=new a.Quat(0,b);return this.mul(c).mul(this.conj())},a.Quat.prototype.toMatrix3x3=function(){var b=this._r,c=this._v.x(),d=this._v.y(),e=this._v.z(),f=c*c,g=d*d,h=e*e,i=c*d,j=c*e,k=d*e,l=b*c,m=b*d,n=b*e;return new a.Matrix3x3([[1-2*(g+h),2*(i-n),2*(m+j)],[2*(i+n),1-2*(f+h),2*(k-l)],[2*(j-m),2*(k+l),1-2*(f+g)]])},a.Quat.prototype.toString=function(){return this._r+","+this._v},a.rayFromPoints=function(b,c){return new a.Ray(b,c.sub(b))},a.rayFromPointDir=function(b,c){return new a.Ray(b,c)},a.Ray=function(a,b){this._start=a,this._direction=b.unit()},a.Ray.prototype.isEqualTo=function(a){return this._start.isEqualTo(a._start)?!!this._direction.isEqualTo(a._direction):!1},a.Ray.prototype.getStart=function(){return this._start},a.Ray.prototype.getDirection=function(){return this._direction},a.Ray.prototype.getPointAtLength=function(a){return this._start.add(this._direction.mulScalar(a))};var m=1e-6;a.Triangle=function(a,b,c){this._v1=a,this._v2=b,this._v3=c,this._e1=b.sub(a),this._e2=c.sub(a),this._normal=this._e1.cross(this._e2).unit()},a.Triangle.prototype.isEqualTo=function(a){return this._v1.isEqualTo(a._v1)&&this._v2.isEqualTo(a._v2)?!!this._v3.isEqualTo(a._v3):!1},a.Triangle.prototype.getNormal=function(){return this._n},a.Triangle.prototype.intersect=function(a){var b,c,d,e,f,g,h,i,j=a.getStart(),k=a.getDirection();return b=k.cross(this._e2),e=this._e1.dot(b),e>-m&&m>e||(f=1/e,d=j.sub(this._v1),g=d.dot(b)*f,0>g||g>1||(c=d.cross(this._e1),h=k.dot(c)*f,0>h||g+h>1||(i=this._e2.dot(c)*f,m>=i)))?void 0:{object:this,normal:this._normal,ray:a,pointOfIntersect:a.getPointAtLength(i),rayLengthOfIntersect:i}},a.Triangle.prototype.toString=function(){return"pt1="+this._v1+", pt2="+this._v2+", pt3="+this._v3},a.Plane=function(a,b){this._v=a,this._n=b},a.Plane.prototype.isEqualTo=function(a){return this._v.isEqualTo(a._v)?!!this._n.isEqualTo(a._n):!1},a.Plane.prototype.intersect=function(a){var b=this._v,c=this._n,d=a.getStart(),e=a.getDirection(),f=b.sub(d).dot(c),g=e.dot(c);if(0!==g){var h=f/g;if(!(0>=h))return{object:this,normal:this._n,ray:a,pointOfIntersect:a.getPointAtLength(h),rayLengthOfIntersect:h}}},a.Plane.prototype.toString=function(){return"p="+this._v+", n="+this._n},a.box3dFromElements=function(b,c,d,e,f,g){this._pt1=a.vector3dFromElements(b,c,d),this._pt2=a.vector3dFromElements(e,f,g)},a.Box3d=function(a,b){this._pt1=a,this._pt2=b},a.Box3d.prototype.isEqualTo=function(a){return this._pt1.isEqualTo(a._pt1)?!!this._pt2.isEqualTo(a._pt2):!1},a.Box3d.prototype.containsPoint=function(a){return a.x()<this._pt1.x()||a.x()>this._pt2.x()?!1:a.y()<this._pt1.y()||a.y()>this._pt2.y()?!1:!(a.z()<this._pt1.z()||a.z()>this._pt2.z())},a.Box3d.prototype.intersects=function(b){var c=b._pt1,d=a.vector2dFromElements(b._pt1.x(),b._pt1.y(),b._pt2.z()),e=a.vector2dFromElements(b._pt1.x(),b._pt2.y(),b._pt1.z()),f=a.vector2dFromElements(b._pt1.x(),b._pt2.y(),b._pt2.z()),g=a.vector2dFromElements(b._pt2.x(),b._pt1.y(),b._pt1.z()),h=a.vector2dFromElements(b._pt2.x(),b._pt1.y(),b._pt2.z()),i=a.vector2dFromElements(b._pt2.x(),b._pt2.y(),b._pt1.z()),j=b._pt2;if(this.containsPoint(c))return!0;if(this.containsPoint(d))return!0;if(this.containsPoint(e))return!0;if(this.containsPoint(f))return!0;if(this.containsPoint(g))return!0;if(this.containsPoint(h))return!0;if(this.containsPoint(i))return!0;if(this.containsPoint(j))return!0;var k=this._pt1,l=a.vector2dFromElements(this._pt1.x(),this._pt1.y(),this._pt2.z()),m=a.vector2dFromElements(this._pt1.x(),this._pt2.y(),this._pt1.z()),n=a.vector2dFromElements(this._pt1.x(),this._pt2.y(),this._pt2.z()),o=a.vector2dFromElements(this._pt2.x(),this._pt1.y(),this._pt1.z()),p=a.vector2dFromElements(this._pt2.x(),this._pt1.y(),this._pt2.z()),q=a.vector2dFromElements(this._pt2.x(),this._pt2.y(),this._pt1.z()),r=this._pt2;return b.containsPoint(k)?!0:b.containsPoint(l)?!0:b.containsPoint(m)?!0:b.containsPoint(n)?!0:b.containsPoint(o)?!0:b.containsPoint(p)?!0:b.containsPoint(q)?!0:!!b.containsPoint(r)},a.Box3d.prototype.toString=function(){return"p1="+this._pt1+", pt2="+this._pt2},a.box2dFromElements=function(b,c,d,e){this._pt1=a.vector2dFromElements(b,c),this._pt2=a.vector2dFromElements(d,e)},a.Box2d=function(a,b){this._pt1=a,this._pt2=b},a.Box2d.prototype.isEqualTo=function(a){return this._pt1.isEqualTo(a._pt1)?!!this._pt2.isEqualTo(a._pt2):!1},a.Box2d.prototype.containsPoint=function(a){return a.x()<this._pt1.x()||a.x()>this._pt2.x()?!1:!(a.y()<this._pt1.y()||a.y()>this._pt2.y())},a.Box2d.prototype.intersects=function(b){var c=b._pt1,d=b._pt2,e=a.vector2dFromElements(b._pt1.x(),b._pt2.y()),f=a.vector2dFromElements(b._pt2.x(),b._pt1.y());if(this.containsPoint(c))return!0;if(this.containsPoint(d))return!0;if(this.containsPoint(e))return!0;if(this.containsPoint(f))return!0;var g=this._pt1,h=this._pt2,i=a.vector2dFromElements(this._pt1.x(),this._pt2.y()),j=a.vector2dFromElements(this._pt2.x(),this._pt1.y());return b.containsPoint(g)?!0:b.containsPoint(h)?!0:b.containsPoint(i)?!0:!!b.containsPoint(j)},a.Box2d.prototype.toString=function(){return"p1="+this._pt1+", pt2="+this._pt2},a.Sphere=function(a,b){this._v=a,this._r=b,this._r2=b*b},a.Sphere.prototype.isEqualTo=function(a){return this._v.isEqualTo(a._v)?this._r===a._r:!1},a.Sphere.prototype.intersect=function(a){var b=this._v,c=this._r,d=a.getStart(),e=a.getDirection(),f=d.sub(b),g=e.dot(f),h=f.lengthSquared(),i=g*g-h+c*c;if(!(0>i)){var j;if(0===i)j=-g;else{var k=Math.sqrt(i),l=-g-k,m=-g+k;j=m>l?l:m}var n=a.getPointAtLength(j),o=n.sub(b).unit();return{object:this,normal:o,ray:a,pointOfIntersect:n,rayLengthOfIntersect:j}}},a.Sphere.prototype.getBoundingBox3d=function(){var b=this._v.x(),c=this._v.y(),d=this._v.z();return new module.exports.Box3d(new a.vector3dFromElements(b-this._r,c-this._r,d-this._r),new a.vector3dFromElements(b+this._r,c+this._r,d+this._r))},a.Sphere.prototype.containsPoint=function(a){return this._v.sub(a).lengthSquared()<=this._r2},a.Sphere.prototype.toString=function(){return"c="+this._v+", r="+this._r},a.Line2d=function(a,b){this._p1=a,this._p2=b},a.Line2d.prototype.isEqualTo=function(a){return this._p1.isEqualTo(a._p1)?!!this._p2.isEqualTo(a._p2):!1},a.Line2d.prototype.getDirection=function(){return this._p2.sub(this._p1)},a.Line2d.prototype.getAngleToXAxis=function(){var a=this.getDirection();return Math.atan2(a.y(),a.x())},a.Line2d.prototype.isPointOnLeftOfLine=function(b){var c=new a.Line2d(this._p1,b),d=new a.Line2d(this._p1,this._p2),f=e(c.getAngleToXAxis()),g=e(d.getAngleToXAxis());return e(f-g)>=0},a.Line2d.prototype.toString=function(){return"p1="+this._p1+", p2="+this._p2},a.Polygon2d=function(a){this._corners=a},a.Polygon2d.prototype.getCorners=function(){return this._corners},a.Polygon2d.prototype.isEqualTo=function(a){for(var b=0;b<this._corners.length;b++){var c=this._corners[b],d=a._corners[b];if(!c.isEqualTo(d))return!1}return!0},a.Polygon2d.prototype.containsPoint=function(a){for(var b=!1,c=this._corners.length,d=0,e=c-1;c>d;e=d++){var f=this._corners[d].x(),g=this._corners[d].y(),h=this._corners[e].x(),i=this._corners[e].y(),j=a.x(),k=a.y(),l=g>k,m=i>k,n=j,o=(h-f)*(k-g)/(i-g)+f;l!==m&&o>n&&(b=!b)}return b},a.Polygon2d.prototype.toString=function(){var a;return this._corners.forEach(function(b){a+=a?"; "+b:b}),a},a.createBoundingPolygon=function(b){if(0===b.length)return[];var c,d=function(){var a;return b.forEach(function(b){a?a.x()>b.x()&&(a=b):a=b}),a},e=function(b,c,d){var e=new a.Line2d(c,d);return e.isPointOnLeftOfLine(b)},f=[],g=d(),h=0;do{f[h]=g,c=void 0;for(var i=0;i<b.length;i++){var j=b[i];if(g!==j&&(void 0===c&&(c=j),c===g||e(j,g,c))){if(g.isEqualTo(j))return;c=j}}g=c,h+=1}while(!c.isEqualTo(f[0]));return f}}("undefined"==typeof exports?this.vecmat={}:exports);